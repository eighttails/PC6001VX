			  Z80 ASSEMBLER - ZASM VER 1.6
                      	;Compatible BASIC for PC-6001mkII/6601
                      	; by AKIKAWA, Hisashi  2017-2020
                      	
                      	;This software is redistributable under the LGPLv2.1 or any later version.
                      	
                      	
  4000                	TALK	equ	4000h
                      	
  0000                	MF	equ	0000h		;male/female
  0001                	SPEED	equ	0001h		;0-4
  0002                	COMMAND	equ	0002h		;0-4,fe
  0003                	QMAG	equ	0003h		;0 or 4
  0004                	VOICED	equ	0004h		;0=unvoiced 1=voiced
  0005                	TDIFF	equ	0005h		;time residual frames
  0006                	PDIFF	equ	0006h		;pitch difference
  0007                	APSTCNT	equ	0007h		;apostrophe counter
  0008                	SYLBCNT	equ	0008h		;syllable counter
  0009                	WORDCNT	equ	0009h		;word counter
  000A                	TMPPTCH	equ	000ah		;temporary pitch (for ^ and +)
  000B                	HATCNT	equ	000bh		;^ counter
  000C                	PLUSCNT	equ	000ch		;+ counter
  000E                	OUTADR	equ	000eh		;output address
                      	
                      	;sing
  0010                	SHARP	equ	0010h		;#
  0011                	VOLUME	equ	0011h		;V-value << 4
  0012                	OCTAVE	equ	0012h		;O-value
  0013                	LENGTH	equ	0013h		;L-value (by frames)
  0014                	REST	equ	0014h		;rest or not
  0015                	MMLPTCH	equ	0015h		;MML pitch
  0016                	MMLLEN	equ	0016h		;MML length
  0017                	MMLADR	equ	0017h		;MML address
  FA5A                	KEYFLG	equ	0fa5ah		;special key flags
  0020                	F1	equ	0020h		;f1,f1diff,b1,b1diff,...,b5diff(0033h)
  0021                	F1DIFF	equ	0021h
  0040                	STACK	equ	0040h
  0300                	WORK	equ	0300h
                      	
                      	;for subtitles in PC6001VW
  00A6                	VWWK62	equ	00a6h		;work area for mkII
  01D3                	VWWK66	equ	01d3h		;work area for 6601
  4D59                	OUTE362	equ	4d59h		;out to port-e3h
  52F2                	OUTE366	equ	52f2h		;out to port-e3h
                      	;
                      	
  0010                	FRAMES	equ	10h		;frames for 1 syllable
  0040                	FRAMES2	equ	40h		;frmaes (sing)
                      	;FRAMES2	equ	48h		;frmaes (sing)
                      	;FRAMES2	equ	4ch		;frmaes (sing)
                      	
                      	
                      	;;;;;;;;;;;;;;;;;;;;;;;;;
                      	
  4000                		org	4000h
                      	
                      	;input: hl=string address, e=length
                      	;destroy: af,bc,de,hl,af',bc',d',hl'
  4000                	_TALK:	ds	TALK-_TALK
  4000                		org	TALK
                      	
  4000  ED734000      		ld	(STACK),sp
                      	
                      	;check male/female
  4004  7B            		ld	a,e
  4005  B7            		or	a
  4006  CABA41        		jp	z,TALKERR
                      	
  4009  7E            		ld	a,(hl)
  400A  F620          		or	20h
  400C  FE66          		cp	'f'
  400E  2805          		jr	z,MFOK
  4010  FE6D          		cp	'm'
  4012  C2BA41        		jp	nz,TALKERR
  4015                	MFOK:
  4015  320000        		ld	(MF),a
  4018  57            		ld	d,a
                      	
  4019  1D            		dec	e
  401A  CABA41        		jp	z,TALKERR
  401D  23            		inc	hl
                      	
                      	
                      	;check speed ((1)-6, space=2)
  401E  7E            		ld	a,(hl)
  401F  FE20          		cp	' '
  4021  2002          		jr	nz,CHKSPD1
  4023  3E32          		ld	a,'2'
  4025                	CHKSPD1:
  4025  D631          		sub	'1'
  4027  2009          		jr	nz,CHKSPD2
  4029  3A5AFA        		ld	a,(KEYFLG)
  402C  E620          		and	20h
  402E  CABA41        		jp	z,TALKERR
  4031  AF            		xor	a
  4032                	CHKSPD2:
  4032  FE06          		cp	6-1+1
  4034  D2BA41        		jp	nc,TALKERR
  4037  320100        		ld	(SPEED),a
                      	
  403A  1D            		dec	e
  403B  CABA41        		jp	z,TALKERR
  403E  23            		inc	hl
                      	
                      	;for subtitles in PC6001VW
  403F  E5            		push	hl
  4040  210100        		ld	hl,0001h	;length+1
  4043  22A600        		ld	(VWWK62),hl
  4046  22D301        		ld	(VWWK66),hl
  4049  E1            		pop	hl
                      	;
                      	
                      	;check internal messages(0-4)/sing(#)/talk(others)
  404A  7E            		ld	a,(hl)
  404B  D630          		sub	'0'
  404D  FE05          		cp	'4'-'0'+1
  404F  DA4D46        		jp	c,TALKOUT	;internal message
                      	
  4052  1D            		dec	e
  4053  CABA41        		jp	z,TALKERR
                      	
                      	;clear work area
  4056  D9            		exx
  4057  212000        		ld	hl,F1
  405A  0614          		ld	b,4*5
  405C                	CLRLP:
  405C  3600          		ld	(hl),00h
  405E  23            		inc	hl
  405F  10FB          		djnz	CLRLP
  4061  210003        		ld	hl,WORK
  4064  220E00        		ld	(OUTADR),hl
  4067  70            		ld	(hl),b		;b=0
  4068  211000        		ld	hl,SHARP
  406B  70            		ld	(hl),b
  406C  23            		inc	hl
  406D  36A0          		ld	(hl),0a0h	;VOLUME
  406F  D9            		exx
                      	
  4070  E5            		push	hl
  4071  D5            		push	de
                      	
  4072  FEF3          		cp	'#'-'0'
  4074  280E          		jr	z,PRESING
                      	
  4076  7A            		ld	a,d
  4077  FE66          		cp	'f'
  4079  3E06          		ld	a,06h
  407B  2802          		jr	z,FEMALE
  407D  3E27          		ld	a,27h
  407F                	FEMALE:
  407F  320600        		ld	(PDIFF),a
  4082  1833          		jr	SETPITCH
                      	
                      	
                      	;prepare for singing
  4084                	PRESING:
  4084  1D            		dec	e
  4085  CABA41        		jp	z,TALKERR
  4088  23            		inc	hl
  4089  7E            		ld	a,(hl)
  408A  FE3A          		cp	':'
  408C  20F6          		jr	nz,PRESING
  408E  23            		inc	hl
  408F  221700        		ld	(MMLADR),hl
  4092  7B            		ld	a,e
  4093  321600        		ld	(MMLLEN),a
                      	
  4096  E5            		push	hl
  4097  F5            		push	af
                      	
  4098  211000        		ld	hl,SHARP
  409B  3601          		ld	(hl),01h
  409D  23            		inc	hl
  409E  3680          		ld	(hl),080h	;VOLUME
  40A0  23            		inc	hl
  40A1  3604          		ld	(hl),04h	;OCTAVE
  40A3  23            		inc	hl
  40A4  3640          		ld	(hl),FRAMES2	;LENGTH
  40A6  23            		inc	hl
  40A7  3600          		ld	(hl),00h	;REST
  40A9  23            		inc	hl
  40AA  3600          		ld	(hl),00h	;MMLPTCH
                      	
  40AC  CD8E47        		call	ANAMML
  40AF  F1            		pop	af
  40B0  E1            		pop	hl
  40B1  221700        		ld	(MMLADR),hl
  40B4  321600        		ld	(MMLLEN),a
                      	
  40B7                	SETPITCH:
  40B7  210003        		ld	hl,WORK
  40BA  CDAF49        		call	CHGRAM0
  40BD                	PRESINGLP:
  40BD  3A0600        		ld	a,(PDIFF)
  40C0  B7            		or	a		;
  40C1  280A          		jr	z,PRESINGEND
  40C3  3E01          		ld	a,1
  40C5  320500        		ld	(TDIFF),a
  40C8  CD4A49        		call	NOSOUND1
  40CB  18F0          		jr	PRESINGLP
                      	
  40CD                	PRESINGEND:
  40CD  CDB549        		call	CHGROM0
  40D0  220E00        		ld	(OUTADR),hl
                      	
  40D3  D1            		pop	de
  40D4  E1            		pop	hl
                      	;	jr	TALKEXT
                      	
                      	
                      	;external message
                      	;d=male/female, e=length, hl=string address
  40D5                	TALKEXT:
  40D5  23            		inc	hl
  40D6  7E            		ld	a,(hl)
  40D7  FE20          		cp	' '
  40D9  2006          		jr	nz,EXTOK
  40DB  1D            		dec	e
  40DC  CABA41        		jp	z,TALKERR
  40DF  18F4          		jr	TALKEXT
                      	
  40E1                	EXTOK:
  40E1  AF            		xor	a
  40E2  320800        		ld	(SYLBCNT),a
  40E5  320900        		ld	(WORDCNT),a
                      	
  40E8                	EXTLP1:
  40E8  CDAF49        		call	CHGRAM0
  40EB  3A0900        		ld	a,(WORDCNT)
  40EE  3C            		inc	a
  40EF  FE04          		cp	4
  40F1  D2BA41        		jp	nc,TALKERR
  40F4  320900        		ld	(WORDCNT),a
  40F7  CDB549        		call	CHGROM0
  40FA  AF            		xor	a
  40FB  320A00        		ld	(TMPPTCH),a
  40FE  320B00        		ld	(HATCNT),a
                      	
                      	;word start
  4101  AF            		xor	a
  4102  320700        		ld	(APSTCNT),a
  4105  320C00        		ld	(PLUSCNT),a
  4108  320600        		ld	(PDIFF),a
  410B                	EXTLP2:
  410B  3E10          		ld	a,FRAMES
  410D  320500        		ld	(TDIFF),a
  4110  CD8E47        		call	ANAMML
  4113                	EXTLP3:
  4113  7E            		ld	a,(hl)
                      	;	cp	'.'
                      	;	jp	z,EXTEND
                      	;	cp	':'
                      	;	jp	z,EXTEND
                      	
  4114  FE5E          		cp	'^'
  4116  CAC741        		jp	z,HAT
  4119  FE2B          		cp	'+'
  411B  CA0342        		jp	z,PLUS
                      	
                      	;for subtitles in PC6001VW
  411E  57            		ld	d,a		;
  411F  CDAF49        		call	CHGRAM0
  4122  E5            		push	hl
  4123  2AA600        		ld	hl,(VWWK62)
  4126  2C            		inc	l		;h=0
  4127  7D            		ld	a,l
  4128  32A600        		ld	(VWWK62),a
  412B  32D301        		ld	(VWWK66),a
  412E  01A600        		ld	bc,VWWK62
  4131  09            		add	hl,bc
  4132  72            		ld	(hl),d		;
  4133  012D01        		ld	bc,VWWK66-VWWK62
  4136  09            		add	hl,bc
  4137  72            		ld	(hl),d		;
  4138  E1            		pop	hl
  4139  CDB549        		call	CHGROM0
  413C  7A            		ld	a,d		;
                      	;
                      	
  413D  F620          		or	20h		;lowercase
  413F  CDE548        		call	CHKVOW
  4142  CA8044        		jp	z,VOWEL
                      	
                      	
                      	;consonant
  4145  1D            		dec	e
  4146  CABA41        		jp	z,TALKERR
                      	
  4149  47            		ld	b,a		;
  414A  23            		inc	hl
                      	
  414B  E5            		push	hl
  414C  D5            		push	de
                      	
  414D  7E            		ld	a,(hl)
  414E  5F            		ld	e,a
                      	
  414F  F620          		or	20h		;
  4151  0E01          		ld	c,1
  4153  FE79          		cp	'y'
  4155  2806          		jr	z,EXTZ		;contracted sound
  4157  CDE548        		call	CHKVOW
  415A  C2BA41        		jp	nz,TALKERR
  415D                	EXTZ:
                      	
  415D  CDFA48        		call	GETOUTADR
  4160  EB            		ex	de,hl
                      	
                      	
                      	;voiced sound
                      	;b=character, c=vowel(0-4), de=output address, h=male/female, l=next character
  4161  3E01          		ld	a,01h
  4163  320400        		ld	(VOICED),a
                      	
  4166  78            		ld	a,b		;
  4167  FE62          		cp	'b'
  4169  CACA43        		jp	z,CON_B
  416C  FE64          		cp	'd'
  416E  CA0644        		jp	z,CON_D
  4171  FE67          		cp	'g'
  4173  CA1044        		jp	z,CON_G
  4176  FE77          		cp	'w'
  4178  CA1A44        		jp	z,CON_W
  417B  FE79          		cp	'y'
  417D  CA2C44        		jp	z,CON_Y
  4180  FE72          		cp	'r'
  4182  CA3D44        		jp	z,CON_R
  4185  FE6D          		cp	'm'
  4187  CA4344        		jp	z,CON_M
  418A  FE6E          		cp	'n'
  418C  CA4944        		jp	z,CON_N
  418F  FE7A          		cp	'z'
  4191  CA4F44        		jp	z,CON_Z
                      	
                      	;unvoiced sound
  4194  AF            		xor	a
  4195  320400        		ld	(VOICED),a
  4198  78            		ld	a,b		;
                      	
  4199  FE70          		cp	'p'
  419B  CAC643        		jp	z,CON_P
  419E  FE6B          		cp	'k'
  41A0  CA1044        		jp	z,CON_K
  41A3  FE74          		cp	't'
  41A5  CA0644        		jp	z,CON_T
  41A8  FE73          		cp	's'
  41AA  CA5544        		jp	z,CON_S
  41AD  FE68          		cp	'h'
  41AF  CA5B44        		jp	z,CON_H
  41B2  FE63          		cp	'c'
  41B4  CA7544        		jp	z,CON_C
  41B7  C3BA41        		jp	TALKERR
                      	
                      	
  41BA                	TALKERR:
  41BA  CDAF49        		call	CHGRAM0
  41BD  2A4000        		ld	hl,(STACK)
  41C0  CDB549        		call	CHGROM0
  41C3  F9            		ld	sp,hl
  41C4  3E01          		ld	a,01h
  41C6  C9            		ret
                      	
                      	
  41C7                	HAT:
  41C7  3E01          		ld	a,01h
  41C9  320B00        		ld	(HATCNT),a
  41CC  23            		inc	hl
  41CD  7E            		ld	a,(hl)
  41CE  FE5E          		cp	'^'
  41D0  CABA41        		jp	z,TALKERR
  41D3  FE2B          		cp	'+'
  41D5  3EFA          		ld	a,0-6
  41D7  200C          		jr	nz,HATNZ
  41D9  3E01          		ld	a,01h
  41DB  320C00        		ld	(PLUSCNT),a
  41DE  23            		inc	hl
  41DF  1D            		dec	e
  41E0  CABA41        		jp	z,TALKERR
  41E3  3EF1          		ld	a,0-15
  41E5                	HATNZ:
  41E5  320A00        		ld	(TMPPTCH),a
  41E8  47            		ld	b,a
  41E9  CDAF49        		call	CHGRAM0
                      	
  41EC  3A1000        		ld	a,(SHARP)
  41EF  B7            		or	a
  41F0  200B          		jr	nz,HATEND
                      	
  41F2  3A0600        		ld	a,(PDIFF)
  41F5  80            		add	a,b
  41F6  320600        		ld	(PDIFF),a
  41F9  1D            		dec	e
  41FA  CABA41        		jp	z,TALKERR
  41FD                	HATEND:
  41FD  CDB549        		call	CHGROM0
  4200  C31341        		jp	EXTLP3
                      	
                      	
  4203                	PLUS:
  4203  23            		inc	hl
  4204  7E            		ld	a,(hl)
  4205  FE2B          		cp	'+'
  4207  CABA41        		jp	z,TALKERR
  420A  FE5E          		cp	'^'
  420C  CABA41        		jp	z,TALKERR
                      	
  420F  CDAF49        		call	CHGRAM0
                      	
  4212  3A1000        		ld	a,(SHARP)
  4215  B7            		or	a
  4216  2023          		jr	nz,PLUSEND
                      	
  4218  3A0600        		ld	a,(PDIFF)
  421B  47            		ld	b,a
  421C  3A0B00        		ld	a,(HATCNT)
  421F  B7            		or	a
  4220  2809          		jr	z,PLUSZ
                      	;^+
  4222  3EF1          		ld	a,0-15
  4224  320A00        		ld	(TMPPTCH),a
  4227  3EF7          		ld	a,0-9
  4229  1805          		jr	PLUSPDIFF
                      	
  422B                	PLUSZ:
  422B  3EFA          		ld	a,0-6
  422D  320A00        		ld	(TMPPTCH),a
  4230                	PLUSPDIFF:
  4230  80            		add	a,b
  4231  320600        		ld	(PDIFF),a
  4234  CDB549        		call	CHGROM0
                      	
  4237  1D            		dec	e
  4238  CABA41        		jp	z,TALKERR
                      	
  423B                	PLUSEND:
  423B  3E01          		ld	a,01h
  423D  320C00        		ld	(PLUSCNT),a
                      	
  4240  C31341        		jp	EXTLP3
                      	
  4243                	APOST:
  4243  CDAF49        		call	CHGRAM0
  4246  3A0700        		ld	a,(APSTCNT)
  4249  B7            		or	a
  424A  C2BA41        		jp	nz,TALKERR
  424D  3C            		inc	a
  424E  320700        		ld	(APSTCNT),a
                      	
  4251  3A1000        		ld	a,(SHARP)
  4254  B7            		or	a
  4255  CDB549        		call	CHGROM0
  4258  C2B744        		jp	nz,VOWEND
  425B  CDAF49        		call	CHGRAM0
                      	
  425E  E5            		push	hl
  425F  2A0E00        		ld	hl,(OUTADR)
  4262  0196FF        		ld	bc,0-(FRAMES*7-6)
  4265  09            		add	hl,bc
  4266  010700        		ld	bc,7
  4269                	APOSTLP:
  4269  7E            		ld	a,(hl)
  426A  E607          		and	07h
  426C  2803          		jr	z,APOSTZ
  426E  09            		add	hl,bc
  426F  18F8          		jr	APOSTLP
                      	
  4271                	APOSTZ:
  4271  3A1100        		ld	a,(VOLUME)
  4274  F605          		or	05h
  4276  77            		ld	(hl),a		;bit7-4=amp, bit3=FV, bit2-0=pitch=-3
  4277  09            		add	hl,bc
  4278  77            		ld	(hl),a
  4279  CDB549        		call	CHGROM0
  427C  E1            		pop	hl
  427D  1D            		dec	e
  427E  CA3D46        		jp	z,EXTEND
  4281  3E0C          		ld	a,12		;PDIFF=+12
  4283  320600        		ld	(PDIFF),a
  4286  C3B744        		jp	VOWEND
                      	
                      	
  4289                	SPACELP:
  4289  23            		inc	hl
  428A                	SPACE:
  428A  1D            		dec	e
  428B  CA3D46        		jp	z,EXTEND
  428E  7E            		ld	a,(hl)
  428F  FE20          		cp	' '
  4291  28F6          		jr	z,SPACELP
  4293  FE5E          		cp	'^'
  4295  CABA41        		jp	z,TALKERR
  4298  E5            		push	hl
  4299  CDAF49        		call	CHGRAM0
                      	
  429C  3A1000        		ld	a,(SHARP)
  429F  B7            		or	a
  42A0  2021          		jr	nz,NOPLUS
                      	
                      	
                      	;	ld	hl,(OUTADR)
                      	;	dec	hl
                      	;	ld	(hl),0c3h	;pitch=+3
                      	;	ld	hl,TMPPTCH
                      	;	ld	a,(hl)
                      	;	add	a,3
                      	;	ld	(hl),a
                      	
  42A2  3A0C00        		ld	a,(PLUSCNT)
  42A5  B7            		or	a
  42A6  281B          		jr	z,NOPLUS
                      	
  42A8  210600        		ld	hl,PDIFF
  42AB  3A0B00        		ld	a,(HATCNT)
  42AE  B7            		or	a
  42AF  7E            		ld	a,(hl)
  42B0  280A          		jr	z,NOHAT
                      	
  42B2  C609          		add	a,9
  42B4  77            		ld	(hl),a
  42B5  3EFA          		ld	a,0-6
  42B7  320A00        		ld	(TMPPTCH),a
  42BA  1807          		jr	NOPLUS
                      	
  42BC                	NOHAT:
  42BC  C606          		add	a,6
  42BE  77            		ld	(hl),a
  42BF  AF            		xor	a
  42C0  320A00        		ld	(TMPPTCH),a
                      	
  42C3                	NOPLUS:
  42C3  3A0700        		ld	a,(APSTCNT)
  42C6  B7            		or	a
  42C7  2807          		jr	z,NOAPST1
  42C9  210600        		ld	hl,PDIFF
  42CC  7E            		ld	a,(hl)
  42CD  D606          		sub	6
  42CF  77            		ld	(hl),a
  42D0                	NOAPST1:
                      	
  42D0  AF            		xor	a
  42D1  320C00        		ld	(PLUSCNT),a
  42D4  320700        		ld	(APSTCNT),a
                      	
  42D7  CDB549        		call	CHGROM0
  42DA  E1            		pop	hl
                      	
  42DB  7E            		ld	a,(hl)
  42DC  23            		inc	hl
  42DD  FE3F          		cp	'?'
  42DF  CA7343        		jp	z,QMARK
  42E2  FE2F          		cp	'/'
  42E4  CAEC42        		jp	z,SLASH
  42E7  2B            		dec	hl
                      	
  42E8  C30B41        		jp	EXTLP2
                      	
                      	
  42EB                	SLASHLP1:
  42EB  23            		inc	hl
  42EC                	SLASH:
  42EC  1D            		dec	e
  42ED  CABA41        		jp	z,TALKERR
  42F0  7E            		ld	a,(hl)
  42F1  FE20          		cp	' '
  42F3  28F6          		jr	z,SLASHLP1
  42F5  FE2E          		cp	'.'
  42F7  CABA41        		jp	z,TALKERR
  42FA  FE3A          		cp	':'
  42FC  CABA41        		jp	z,TALKERR
                      	
  42FF  E5            		push	hl
  4300  D5            		push	de
                      	
  4301  CDAF49        		call	CHGRAM0
                      	
  4304  3A1000        		ld	a,(SHARP)
  4307  B7            		or	a
  4308  2038          		jr	nz,QSLSING
                      	
  430A  2A0E00        		ld	hl,(OUTADR)
  430D  2B            		dec	hl
  430E  3A1100        		ld	a,(VOLUME)
  4311  F603          		or	03h
  4313  77            		ld	(hl),a		;pitch=+3
  4314  23            		inc	hl
  4315  3A0600        		ld	a,(PDIFF)
  4318  4F            		ld	c,a
  4319  3A0A00        		ld	a,(TMPPTCH)
  431C  91            		sub	c
  431D  4F            		ld	c,a
  431E  CDB549        		call	CHGROM0	
  4321  0C            		inc	c
  4322  0C            		inc	c
  4323  0C            		inc	c
                      	
                      	;? and /
                      	;input: hl=output address, c=pdiff
  4324                	QSLASH:
  4324  CDAF49        		call	CHGRAM0
  4327  3A0700        		ld	a,(APSTCNT)
  432A  B7            		or	a
  432B  79            		ld	a,c
  432C  2802          		jr	z,NOAPST2
  432E  C606          		add	a,6
  4330                	NOAPST2:
  4330  ED44          		neg
  4332  320600        		ld	(PDIFF),a
  4335  3E20          		ld	a,FRAMES*2
  4337  320500        		ld	(TDIFF),a
  433A  CD4A49        		call	NOSOUND1
  433D  D1            		pop	de
  433E  E1            		pop	hl
  433F  C3E840        		jp	EXTLP1
                      	
                      	
                      	;q and / for singing
                      	;input: hl=string address
  4342                	QSLSING:
  4342  7E            		ld	a,(hl)
  4343  FE3A          		cp	':'		;for ?
  4345  287A          		jr	z,QMARKZ2
  4347  3E01          		ld	a,1
  4349  321400        		ld	(REST),a
  434C  3E10          		ld	a,FRAMES
  434E  320500        		ld	(TDIFF),a
  4351  CD8E47        		call	ANAMML
  4354  CDAF49        		call	CHGRAM0
  4357  3A1400        		ld	a,(REST)
  435A  B7            		or	a
  435B  CABA41        		jp	z,TALKERR
  435E  AF            		xor	a
  435F  321400        		ld	(REST),a
  4362  2A0E00        		ld	hl,(OUTADR)
  4365  CD4A49        		call	NOSOUND1
  4368  3600          		ld	(hl),0
  436A  CDB549        		call	CHGROM0
  436D  D1            		pop	de
  436E  E1            		pop	hl
  436F  C3E840        		jp	EXTLP1
                      	
                      	
  4372                	QMARKLP1:
  4372  23            		inc	hl
  4373                	QMARK:
  4373  1D            		dec	e
  4374  280A          		jr	z,QMARKZ1
  4376  7E            		ld	a,(hl)
  4377  FE2E          		cp	'.'
  4379  CABA41        		jp	z,TALKERR
  437C  FE20          		cp	' '
  437E  28F2          		jr	z,QMARKLP1
  4380                	QMARKZ1:
  4380  1C            		inc	e
                      	
  4381  E5            		push	hl
  4382  D5            		push	de
                      	
  4383  CDAF49        		call	CHGRAM0
  4386  3A1000        		ld	a,(SHARP)
  4389  B7            		or	a
  438A  20B6          		jr	nz,QSLSING
                      	
  438C  3A0600        		ld	a,(PDIFF)
  438F  4F            		ld	c,a
  4390  210A00        		ld	hl,TMPPTCH
  4393  7E            		ld	a,(hl)
  4394  D615          		sub	21
  4396  77            		ld	(hl),a
  4397  91            		sub	c
  4398  4F            		ld	c,a
  4399  2A0E00        		ld	hl,(OUTADR)
  439C  2B            		dec	hl
  439D  11F9FF        		ld	de,0-7
  43A0  0607          		ld	b,07h
  43A2                	QMARKLP2:
  43A2  7E            		ld	a,(hl)
  43A3  F605          		or	05h
  43A5  77            		ld	(hl),a
  43A6  19            		add	hl,de
  43A7  10F9          		djnz	QMARKLP2
                      	
                      	;	ld	hl,(OUTADR)
                      	;	call	CHGROM0
                      	;
                      	;	pop	de
                      	;	dec	e
                      	;	push	de
                      	;	jp	nz,QSLASH
                      	;
                      	;	pop	de
                      	;	pop	hl
                      	;	jp	EXTEND
                      	
                      	
  43A9  D1            		pop	de
  43AA  E1            		pop	hl
  43AB  E5            		push	hl
  43AC  1D            		dec	e
  43AD  2813          		jr	z,QMARKZ3
  43AF  7E            		ld	a,(hl)
  43B0  FE3A          		cp	':'
  43B2  280E          		jr	z,QMARKZ3
  43B4  D5            		push	de
  43B5  CDAF49        		call	CHGRAM0
  43B8  2A0E00        		ld	hl,(OUTADR)
  43BB  CDB549        		call	CHGROM0
  43BE  C22443        		jp	nz,QSLASH
  43C1                	QMARKZ2:
  43C1  D1            		pop	de
  43C2                	QMARKZ3:
  43C2  E1            		pop	hl
  43C3  C33D46        		jp	EXTEND
                      	
                      	
                      	;pa,pi,pu,pe,po
  43C6                	CON_P:
  43C6  3E02          		ld	a,02h
  43C8  1802          		jr	BPCOMMON
                      	
                      	;ba,bi,bu,be,bo
  43CA                	CON_B:
  43CA  3E01          		ld	a,01h
                      	
  43CC                	BPCOMMON:
  43CC  47            		ld	b,a
  43CD  CD6749        		call	NOSOUND2
  43D0  210F53        		ld	hl,BTBL
                      	
                      	;consonant common routine
                      	;input: c=vowel(0-4), de=output address, hl=table address
  43D3                	CONCOMMON:
  43D3  CDAF49        		call	CHGRAM0
  43D6  3A0000        		ld	a,(MF)
  43D9  FE6D          		cp	'm'		;
  43DB  CDB549        		call	CHGROM0
  43DE  79            		ld	a,c
  43DF  2802          		jr	z,BMALE		;
  43E1  C605          		add	a,05h
  43E3                	BMALE:
  43E3  87            		add	a,a
  43E4  4F            		ld	c,a
  43E5  0600          		ld	b,00h
  43E7  09            		add	hl,bc
  43E8  7E            		ld	a,(hl)
  43E9  23            		inc	hl
  43EA  66            		ld	h,(hl)
  43EB  6F            		ld	l,a
  43EC                	CONCOMMON2:
  43EC  46            		ld	b,(hl)
  43ED  23            		inc	hl
  43EE  EB            		ex	de,hl
                      	
  43EF                	BLP:
  43EF  C5            		push	bc
  43F0  D5            		push	de
  43F1  CD9846        		call	PUT7
  43F4  D1            		pop	de
  43F5  EB            		ex	de,hl
  43F6  010A00        		ld	bc,000ah
  43F9  09            		add	hl,bc
  43FA  EB            		ex	de,hl
  43FB  C1            		pop	bc
  43FC  10F1          		djnz	BLP
  43FE  220E00        		ld	(OUTADR),hl
                      	
  4401  D1            		pop	de
  4402  E1            		pop	hl
  4403  C31341        		jp	EXTLP3
                      	
                      	
                      	;da,di,du,de,do
  4406                	CON_D:
  4406                	CON_T:
  4406  0602          		ld	b,02h
  4408  CD6749        		call	NOSOUND2
  440B  212353        		ld	hl,DTBL
  440E  18C3          		jr	CONCOMMON
                      	
                      	;ga,gi,gu,ge,go
  4410                	CON_G:
  4410                	CON_K:
  4410  0602          		ld	b,02h
  4412  CD6749        		call	NOSOUND2
  4415  213753        		ld	hl,GTBL
  4418  18B9          		jr	CONCOMMON
                      	
                      	
                      	;c=0-4
  441A                	CON_W:
  441A  79            		ld	a,c
  441B  B7            		or	a		;wa
  441C  C2BA41        		jp	nz,TALKERR
  441F  7C            		ld	a,h		;male/female
  4420  FE6D          		cp	'm'
  4422  217054        		ld	hl,M_WA
  4425  28C5          		jr	z,CONCOMMON2
  4427  218F54        		ld	hl,F_WA
  442A  18C0          		jr	CONCOMMON2
                      	
                      	
  442C                	CON_Y:
  442C  7D            		ld	a,l		;next character
  442D  FE79          		cp	'y'
  442F  CABA41        		jp	z,TALKERR
  4432  79            		ld	a,c
  4433  3D            		dec	a
  4434  CABA41        		jp	z,TALKERR	;yi
  4437  214B53        		ld	hl,YTBL
  443A  C3D343        		jp	CONCOMMON
                      	
                      	
  443D                	CON_R:
  443D  215F53        		ld	hl,RTBL
  4440  C3D343        		jp	CONCOMMON
                      	
  4443                	CON_M:
  4443  217353        		ld	hl,MTBL
  4446  C3D343        		jp	CONCOMMON
                      	
  4449                	CON_N:
  4449  218753        		ld	hl,NTBL
  444C  C3D343        		jp	CONCOMMON
                      	
  444F                	CON_Z:
                      	;	ld	b,01h
                      	;	call	NOSOUND2
  444F  219B53        		ld	hl,ZTBL
  4452  C3D343        		jp	CONCOMMON
                      	
  4455                	CON_S:
  4455  21AF53        		ld	hl,STBL
  4458  C3D343        		jp	CONCOMMON
                      	
  445B                	CON_H:
  445B  7D            		ld	a,l		;next character
  445C  FE79          		cp	'y'
  445E  2806          		jr	z,CON_HY
  4460  21C353        		ld	hl,HTBL
  4463  C3D343        		jp	CONCOMMON
                      	
  4466                	CON_HY:
  4466  7C            		ld	a,h		;male/female
  4467  FE6D          		cp	'm'
  4469  21F258        		ld	hl,M_HY
  446C  C3EC43        		jp	CONCOMMON2
  446F  21E859        		ld	hl,F_HY
  4472  C3EC43        		jp	CONCOMMON2
                      	
                      	
  4475                	CON_C:
  4475  0602          		ld	b,02h
  4477  CD6749        		call	NOSOUND2
  447A  21D753        		ld	hl,CTBL
  447D  C3D343        		jp	CONCOMMON
                      	
                      	
                      	;c=0-4,d=male/female
  4480                	VOWEL:
  4480  E5            		push	hl
  4481  D5            		push	de
                      	
  4482  3E01          		ld	a,01h
  4484  320400        		ld	(VOICED),a
  4487  23            		inc	hl
  4488  7E            		ld	a,(hl)
                      	
  4489  D62A          		sub	'*'
  448B  2007          		jr	nz,VOWNZ
  448D  320400        		ld	(VOICED),a	;a=0
                      	
  4490  D1            		pop	de
  4491  1D            		dec	e
  4492  E3            		ex	(sp),hl
  4493  D5            		push	de
                      	
  4494                	VOWNZ:
  4494  21FB52        		ld	hl,VOWTBL
  4497  7A            		ld	a,d		;male/female
  4498  FE6D          		cp	'm'
  449A  79            		ld	a,c
  449B  2802          		jr	z,VOWMALE
  449D  C605          		add	a,05h
  449F                	VOWMALE:
  449F  87            		add	a,a
  44A0  4F            		ld	c,a
  44A1  0600          		ld	b,00h
  44A3  09            		add	hl,bc
  44A4  5E            		ld	e,(hl)
  44A5  23            		inc	hl
  44A6  56            		ld	d,(hl)
                      	
  44A7  CDFA48        		call	GETOUTADR
  44AA  CD9846        		call	PUT7
  44AD  CD2545        		call	SYLLABLE
                      	
  44B0  D1            		pop	de
  44B1  E1            		pop	hl
  44B2  23            		inc	hl
  44B3  1D            		dec	e
  44B4  CA3D46        		jp	z,EXTEND
                      	
                      	
  44B7                	VOWEND:
  44B7  7E            		ld	a,(hl)
  44B8  23            		inc	hl
  44B9  FE2E          		cp	'.'
  44BB  CA3D46        		jp	z,EXTEND
  44BE  FE3A          		cp	':'
  44C0  CA3D46        		jp	z,EXTEND
  44C3  FE27          		cp	27h		;apostrophe
  44C5  CA4342        		jp	z,APOST
  44C8  FE20          		cp	' '
  44CA  CA8A42        		jp	z,SPACE
  44CD  FE2F          		cp	'/'
  44CF  CAEC42        		jp	z,SLASH
  44D2  FE3F          		cp	'?'
  44D4  CA7343        		jp	z,QMARK
  44D7  FE2D          		cp	'-'
  44D9  281A          		jr	z,LONG
  44DB  FE2B          		cp	'+'
  44DD  CABA41        		jp	z,TALKERR
  44E0  FE5E          		cp	'^'
  44E2  CABA41        		jp	z,TALKERR
  44E5  F620          		or	20h
  44E7  FE71          		cp	'q'
  44E9  CA6845        		jp	z,GEMINATE
  44EC  FE78          		cp	'x'
  44EE  CAD445        		jp	z,CON_X
                      	
  44F1  2B            		dec	hl
  44F2  C30B41        		jp	EXTLP2
                      	
                      	
                      	;long sound
  44F5                	LONG:
  44F5  7B            		ld	a,e
  44F6  3D            		dec	a
  44F7  280F          		jr	z,LONGZ
  44F9  7E            		ld	a,(hl)
  44FA  FE2D          		cp	'-'
  44FC  CABA41        		jp	z,TALKERR
  44FF  D62A          		sub	'*'
  4501  2005          		jr	nz,LONGZ
  4503  320400        		ld	(VOICED),a	;a=0
  4506  23            		inc	hl
  4507  1D            		dec	e
  4508                	LONGZ:
  4508  E5            		push	hl
  4509  D5            		push	de
  450A  CDFA48        		call	GETOUTADR
  450D  3E10          		ld	a,FRAMES
  450F  320500        		ld	(TDIFF),a
  4512  CD8E47        		call	ANAMML
  4515  AF            		xor	a
  4516  320600        		ld	(PDIFF),a
  4519  CD2545        		call	SYLLABLE
  451C  D1            		pop	de
  451D  E1            		pop	hl
  451E  1D            		dec	e
  451F  CA3D46        		jp	z,EXTEND
  4522  C3B744        		jp	VOWEND
                      	
                      	
                      	
                      	;put a syllable
                      	;hl=output address
  4525                	SYLLABLE:
  4525  CDAF49        		call	CHGRAM0
  4528  3A0800        		ld	a,(SYLBCNT)
  452B  3C            		inc	a
  452C  FE1F          		cp	1fh
  452E  D2BA41        		jp	nc,TALKERR
  4531  320800        		ld	(SYLBCNT),a
                      	
  4534  3A0400        		ld	a,(VOICED)
  4537  F608          		or	08h
  4539  57            		ld	d,a
  453A  3A0500        		ld	a,(TDIFF)
  453D  5F            		ld	e,a
  453E  F608          		or	08h
                      	
  4540  3A1100        		ld	a,(VOLUME)
  4543  4F            		ld	c,a
                      	
  4544                	SYLBLP1:
  4544  72            		ld	(hl),d		;bit7-3=time=1, bit2=qmag=0, bit1=S.I=0, bit0=V/UV
  4545  23            		inc	hl
  4546  0605          		ld	b,05h
  4548                	SYLBLP2:
  4548  3600          		ld	(hl),0		;fn=bn=0
  454A  23            		inc	hl
  454B  10FB          		djnz	SYLBLP2
  454D  CD2549        		call	CHKPDIFF
  4550  B1            		or	c		;volume
  4551  77            		ld	(hl),a		;bit7-4=amp, bit3=FV=0, bit2-0=pitch=0
                      	
  4552  23            		inc	hl
  4553  1D            		dec	e
  4554  20EE          		jr	nz,SYLBLP1
                      	
  4556  3A0600        		ld	a,(PDIFF)
  4559  B3            		or	e
  455A  2803          		jr	z,SYLBEND
  455C  1C            		inc	e
                      	
  455D  18E5          		jr	SYLBLP1
                      	
  455F                	SYLBEND:
                      	
  455F  CDB549        		call	CHGROM0
                      	
  4562  220E00        		ld	(OUTADR),hl
  4565  3600          		ld	(hl),0
                      	;	ld	a,FRAMES
                      	;	ld	(TDIFF),a
  4567  C9            		ret
                      	
                      	
                      	;geminated consonant
  4568                	GEMINATE:
  4568  E5            		push	hl
  4569  D5            		push	de
                      	
  456A                	GEMLP1:
  456A  1D            		dec	e
  456B  CABA41        		jp	z,TALKERR
  456E  7E            		ld	a,(hl)
  456F  23            		inc	hl
  4570  FE20          		cp	' '
  4572  28F6          		jr	z,GEMLP1
                      	
  4574  FE2E          		cp	'.'
  4576  CABA41        		jp	z,TALKERR
  4579  FE3A          		cp	':'
  457B  CABA41        		jp	z,TALKERR
  457E  FE3F          		cp	'?'
  4580  CABA41        		jp	z,TALKERR
                      	
  4583  D1            		pop	de
  4584  E1            		pop	hl
  4585  1D            		dec	e
                      	
  4586  D62A          		sub	'*'
  4588  2005          		jr	nz,GEMNZ
  458A  320400        		ld	(VOICED),a
  458D  23            		inc	hl
  458E  1D            		dec	e
  458F                	GEMNZ:
  458F  E5            		push	hl
  4590  D5            		push	de
  4591  CDFA48        		call	GETOUTADR
  4594  3E10          		ld	a,FRAMES
  4596  320500        		ld	(TDIFF),a
  4599  CD8E47        		call	ANAMML
  459C  CDAF49        		call	CHGRAM0
  459F  CD4A49        		call	NOSOUND1
  45A2  CDB549        		call	CHGROM0
                      	
  45A5  220E00        		ld	(OUTADR),hl
  45A8  3600          		ld	(hl),0
                      	
  45AA  CDAF49        		call	CHGRAM0
  45AD  3A0800        		ld	a,(SYLBCNT)
  45B0  3C            		inc	a
  45B1  FE1F          		cp	1fh
  45B3  D2BA41        		jp	nc,TALKERR
  45B6  320800        		ld	(SYLBCNT),a
  45B9  CDB549        		call	CHGROM0
                      	
  45BC  D1            		pop	de
  45BD  E1            		pop	hl
                      	
  45BE  7E            		ld	a,(hl)
  45BF  23            		inc	hl
  45C0  FE27          		cp	27h		;apostrophe
  45C2  CA4342        		jp	z,APOST
  45C5  FE20          		cp	' '
  45C7  CA8A42        		jp	z,SPACE
  45CA  F620          		or	20h
  45CC  FE78          		cp	'x'
  45CE  2804          		jr	z,CON_X
  45D0  2B            		dec	hl
  45D1  C30B41        		jp	EXTLP2
                      	
                      	
  45D4                	CON_X:
  45D4  3E01          		ld	a,01h
  45D6  320400        		ld	(VOICED),a
  45D9  7B            		ld	a,e
  45DA  3D            		dec	a
  45DB  2815          		jr	z,XZ
  45DD  7E            		ld	a,(hl)
  45DE  D62A          		sub	'*'
  45E0  2004          		jr	nz,XNZ
  45E2  320400        		ld	(VOICED),a	;a=0
  45E5  23            		inc	hl
  45E6                	XNZ:
  45E6  7B            		ld	a,e
  45E7  3D            		dec	a
  45E8  2808          		jr	z,XZ
  45EA  7E            		ld	a,(hl)
  45EB  F620          		or	20h
  45ED  FE78          		cp	'x'
  45EF  CABA41        		jp	z,TALKERR
  45F2                	XZ:
  45F2  E5            		push	hl
  45F3  D5            		push	de
  45F4  CDFA48        		call	GETOUTADR
  45F7  3E10          		ld	a,FRAMES
  45F9  320500        		ld	(TDIFF),a
  45FC  CD8E47        		call	ANAMML
  45FF  11BE57        		ld	de,M_MA+1
  4602  CD9846        		call	PUT7
  4605  CD2545        		call	SYLLABLE
  4608  D1            		pop	de
  4609  E1            		pop	hl
  460A  1D            		dec	e
  460B  CA3D46        		jp	z,EXTEND
                      	
                      	;check xqx
  460E  E5            		push	hl
  460F  D5            		push	de
  4610                	XLP1:
  4610  1D            		dec	e
  4611  2825          		jr	z,XEND
  4613  7E            		ld	a,(hl)
  4614  23            		inc	hl
  4615  FE27          		cp	27h		;apostrophe
  4617  28F7          		jr	z,XLP1
  4619  FE2A          		cp	'*'
  461B  28F3          		jr	z,XLP1
  461D  F620          		or	20h
  461F  FE71          		cp	'q'
  4621  2015          		jr	nz,XEND
                      	
  4623  1C            		inc	e
  4624                	XLP22:
  4624  1D            		dec	e
  4625  2811          		jr	z,XEND
  4627  7E            		ld	a,(hl)
  4628  23            		inc	hl
  4629  FE27          		cp	27h		;apostrophe
  462B  28F7          		jr	z,XLP22
  462D  FE2A          		cp	'*'
  462F  28F3          		jr	z,XLP22
  4631  F620          		or	20h
  4633  FE78          		cp	'x'
  4635  CABA41        		jp	z,TALKERR
                      	
  4638                	XEND:
  4638  D1            		pop	de
  4639  E1            		pop	hl
                      	
                      	
  463A  C3B744        		jp	VOWEND
                      	
                      	
  463D                	EXTEND:
  463D  CDAF49        		call	CHGRAM0
  4640  2A0003        		ld	hl,(WORK)
  4643  CDB549        		call	CHGROM0
  4646  7D            		ld	a,l
  4647  B7            		or	a
  4648  CABA41        		jp	z,TALKERR
                      	
  464B  3EFE          		ld	a,0feh
                      	;	jr	TALKOUT
                      	
  464D                	TALKOUT:
  464D  320200        		ld	(COMMAND),a	;0-4,fe
                      	
  4650                	TALKOUTLP:
  4650  DBE0          		in	a,(0e0h)	;status register
  4652  07            		rlca
  4653  38FB          		jr	c,TALKOUTLP	;busy
                      	
                      	;mode selection data
                      	;bit2: 0=10ms/frame, 1=20ms/frame
                      	;bit10: 00=normal, 01=slow, 10=fast
                      	;123456->012345->201645
  4655  CDAF49        		call	CHGRAM0
  4658  3A0100        		ld	a,(SPEED)	;0-5
  465B  21F552        		ld	hl,SPDTBL
  465E  0600          		ld	b,00h
  4660  4F            		ld	c,a
  4661  09            		add	hl,bc
  4662  7E            		ld	a,(hl)
  4663  D3E2          		out	(0e2h),a	;mode selection
                      	
                      	;command data
  4665  3A0200        		ld	a,(COMMAND)
                      	;	out	(0e3h),a
                      	
                      	;for subtitles in PC6001VW
  4668  CD594D        		call	OUTE362
  466B  CDF252        		call	OUTE366
                      	;
                      	
  466E  FEFE          		cp	0feh
  4670  2012          		jr	nz,TALKEND	;internal message
                      	
                      	;external message
  4672  210003        		ld	hl,WORK
  4675                	EXTMESLP:
  4675  CD7E49        		call	OUT7
  4678  7E            		ld	a,(hl)
  4679  B7            		or	a
  467A  20F9          		jr	nz,EXTMESLP
                      	
  467C  219246        		ld	hl,ENDDATA	;for yaPC-6201/yaPC-6601
  467F  0606          		ld	b,06h
  4681  CD8049        		call	OUT7LP1
                      	
  4684                	TALKEND:
  4684  CDB549        		call	CHGROM0
  4687  3A5AFA        		ld	a,(KEYFLG)
  468A  E6EF          		and	0efh
  468C  325AFA        		ld	(KEYFLG),a
  468F  3E20          		ld	a,20h
  4691  C9            		ret
                      	
  4692                	ENDDATA:
  4692  000000000000  		db	00h, 00h, 00h, 00h, 00h, 00h
                      	
                      	
                      	;input: de=voice data address, hl=output address
                      	;output: hl=output end+1
                      	;destroy: af,bc,de,af',bc',d',hl'
  4698                	PUT7:
  4698  AF            		xor	a		;first data
  4699  F5            		push	af
                      	
  469A                	PUT7LP1:
  469A  D5            		push	de
  469B  E5            		push	hl
  469C  AF            		xor	a
  469D  320300        		ld	(QMAG),a
                      	
                      	;set qmag factor
  46A0  212000        		ld	hl,F1
  46A3  010005        		ld	bc,0500h	;c=no residual?
                      	
  46A6  CDAF49        		call	CHGRAM0
  46A9                	PUT7LP2:
  46A9  1A            		ld	a,(de)
  46AA  96            		sub	(hl)
  46AB  23            		inc	hl
  46AC  77            		ld	(hl),a
  46AD  B1            		or	c
  46AE  4F            		ld	c,a
                      	
  46AF  7E            		ld	a,(hl)
  46B0  C610          		add	a,16
  46B2  FE20          		cp	32
  46B4  3805          		jr	c,NOQMAG1	;-16<=fdiff<=15
  46B6  3E04          		ld	a,04h
  46B8  320300        		ld	(QMAG),a
  46BB                	NOQMAG1:
  46BB  13            		inc	de
  46BC  13            		inc	de
  46BD  13            		inc	de
  46BE  13            		inc	de
  46BF  13            		inc	de
  46C0  23            		inc	hl
                      	
  46C1  1A            		ld	a,(de)
  46C2  96            		sub	(hl)
  46C3  23            		inc	hl
  46C4  77            		ld	(hl),a
  46C5  B1            		or	c
  46C6  4F            		ld	c,a
                      	
  46C7  7E            		ld	a,(hl)
  46C8  C604          		add	a,4
  46CA  FE08          		cp	8
  46CC  3805          		jr	c,NOQMAG2	;-4<=bdiff<=3
  46CE  3E04          		ld	a,04h
  46D0  320300        		ld	(QMAG),a
  46D3                	NOQMAG2:
  46D3  1B            		dec	de
  46D4  1B            		dec	de
  46D5  1B            		dec	de
  46D6  1B            		dec	de
  46D7  23            		inc	hl
  46D8  10CF          		djnz	PUT7LP2
                      	
  46DA  E1            		pop	hl
  46DB  D1            		pop	de
  46DC  F1            		pop	af
  46DD  2805          		jr	z,PUT7Z		;first data?
                      	
                      	;	ld	a,(PDIFF)
                      	;	or	c
                      	
  46DF  79            		ld	a,c
  46E0  B7            		or	a
                      	
                      	
  46E1  CA8D47        		jp	z,PUT7END
                      	
  46E4                	PUT7Z:
  46E4  3E01          		ld	a,01h
  46E6  B7            		or	a
  46E7  F5            		push	af		;z=0
  46E8  D5            		push	de
                      	
  46E9  3A0300        		ld	a,(QMAG)
  46EC  B7            		or	a
  46ED  01F00F        		ld	bc,0ff0h	;-16<=f<=15
  46F0  11FC03        		ld	de,03fch	;-4<=b<=3
  46F3  2806          		jr	z,NOQMAG3
  46F5  01E01E        		ld	bc,1ee0h	;-32<=f<=30
  46F8  11F806        		ld	de,06f8h	;-8<=b<=6
  46FB                	NOQMAG3:
  46FB  D9            		exx
                      	
  46FC  57            		ld	d,a		;qmag
  46FD  CDB549        		call	CHGROM0
                      	
  4700  212100        		ld	hl,F1DIFF
  4703  060A          		ld	b,0ah
                      	
  4705                	PUT7LP3:
  4705  CDAF49        		call	CHGRAM0
  4708  4E            		ld	c,(hl)		;diff
  4709  CDB549        		call	CHGROM0
  470C  79            		ld	a,c
                      	
  470D  D9            		exx
  470E  B7            		or	a
  470F  F21847        		jp	p,PUT7PLS1
                      	;diff<0
  4712  B9            		cp	c
  4713  3007          		jr	nc,DIFFEND
  4715  79            		ld	a,c
  4716  1804          		jr	DIFFEND
                      	
                      	;diff>=0
  4718                	PUT7PLS1:
  4718  B8            		cp	b
  4719  3801          		jr	c,DIFFEND
  471B  78            		ld	a,b
  471C                	DIFFEND:
  471C  D9            		exx
                      	
  471D  14            		inc	d
  471E  15            		dec	d
  471F  2807          		jr	z,NOQMAG4	;qmag=0?
  4721  B7            		or	a
  4722  F22647        		jp	p,PUT7PLS2
  4725  3C            		inc	a
  4726                	PUT7PLS2:
  4726  E6FE          		and	0feh
  4728                	NOQMAG4:
                      	
  4728  2B            		dec	hl
  4729  4F            		ld	c,a
  472A  CDAF49        		call	CHGRAM0
  472D  7E            		ld	a,(hl)
  472E  81            		add	a,c
  472F  77            		ld	(hl),a
  4730  CDB549        		call	CHGROM0
                      	
  4733  7A            		ld	a,d		;qmag=0?
  4734  B7            		or	a
  4735  2802          		jr	z,NOQMAG5
  4737  CB29          		sra	c
  4739                	NOQMAG5:
  4739  79            		ld	a,c
                      	
  473A  23            		inc	hl
  473B  77            		ld	(hl),a
  473C  23            		inc	hl
  473D  23            		inc	hl
  473E  D9            		exx
                      	
                      	;exchange bc and de
  473F  C5            		push	bc
  4740  D5            		push	de
  4741  C1            		pop	bc
  4742  D1            		pop	de
  4743  D9            		exx
                      	
  4744  10BF          		djnz	PUT7LP3
                      	
  4746  CDAF49        		call	CHGRAM0
  4749  3A0400        		ld	a,(VOICED)	;bit0=V/UV
  474C  B2            		or	d		;bit2=qmag
  474D  F608          		or	08h		;bit7-3=time, bit1=S.I
  474F  57            		ld	d,a
  4750  CDB549        		call	CHGROM0
  4753  7A            		ld	a,d
                      	
  4754  D9            		exx
  4755  77            		ld	(hl),a		;bit7-3=time, bit2=qmag, bit1=S.I, bit0=V/UV
  4756  23            		inc	hl
  4757  CDAF49        		call	CHGRAM0
  475A  112100        		ld	de,F1DIFF
  475D  0605          		ld	b,05h
  475F                	PUT7LP4:
  475F  1A            		ld	a,(de)
  4760  E61F          		and	1fh
  4762  87            		add	a,a
  4763  87            		add	a,a
  4764  87            		add	a,a
  4765  4F            		ld	c,a
  4766  13            		inc	de
  4767  13            		inc	de
  4768  1A            		ld	a,(de)
  4769  E607          		and	07h
  476B  13            		inc	de
  476C  13            		inc	de
  476D  B1            		or	c
  476E  77            		ld	(hl),a
  476F  23            		inc	hl
  4770  10ED          		djnz	PUT7LP4
                      	
  4772  CD2549        		call	CHKPDIFF
  4775  47            		ld	b,a
  4776  3A1100        		ld	a,(VOLUME)
  4779  B0            		or	b
                      	
                      	
  477A  77            		ld	(hl),a		;bit7-4=amp, bit3=FV, bit2-0=pitch
  477B  23            		inc	hl
                      	
  477C  3A0500        		ld	a,(TDIFF)
  477F  3D            		dec	a
  4780  2001          		jr	nz,PUT7NZ
  4782  3C            		inc	a
  4783                	PUT7NZ:
  4783  320500        		ld	(TDIFF),a
                      	
  4786  CDB549        		call	CHGROM0
                      	
  4789  D1            		pop	de
  478A  C39A46        		jp	PUT7LP1
                      	
                      	
  478D                	PUT7END:
                      	;	dec	hl
                      	;	ld	(hl),0c0h	;bit7-4=amp, bit3=FV, bit2-0=pitch
                      	;	inc	hl
  478D  C9            		ret
                      	
                      	
                      	;analyze MML for singing
                      	;destroy: af,bc
  478E                	ANAMML:
  478E  CDAF49        		call	CHGRAM0
  4791  3A1000        		ld	a,(SHARP)
  4794  B7            		or	a
  4795  CA3448        		jp	z,MMLEND
                      	
  4798  E5            		push	hl
  4799  D5            		push	de
                      	
                      	
  479A  2A1700        		ld	hl,(MMLADR)
  479D                	MMLLP1:
  479D  3A1600        		ld	a,(MMLLEN)
  47A0  B7            		or	a
  47A1  CABA41        		jp	z,TALKERR
  47A4  3D            		dec	a
  47A5  321600        		ld	(MMLLEN),a
                      		
  47A8  7E            		ld	a,(hl)
  47A9  23            		inc	hl
  47AA  221700        		ld	(MMLADR),hl
                      	
  47AD  FE20          		cp	' '
  47AF  28EC          		jr	z,MMLLP1
                      	
  47B1  F620          		or	20h
  47B3  FE72          		cp	'r'
  47B5  CA7648        		jp	z,SINGR
                      	
  47B8  47            		ld	b,a
  47B9  AF            		xor	a
  47BA  321400        		ld	(REST),a
  47BD  78            		ld	a,b
                      	
  47BE  FE6F          		cp	'o'
  47C0  CA3848        		jp	z,SINGO
  47C3  FE6C          		cp	'l'
  47C5  CA6648        		jp	z,SINGL
  47C8  FE76          		cp	'v'
  47CA  CA5048        		jp	z,SINGV
                      	
  47CD  D661          		sub	'a'
  47CF  FE07          		cp	'g'-'a'+1
  47D1  D2BA41        		jp	nc,TALKERR
  47D4  21225A        		ld	hl,TONETBL
  47D7  1600          		ld	d,0
  47D9  5F            		ld	e,a
  47DA  19            		add	hl,de
  47DB  5E            		ld	e,(hl)
                      	
                      	;check +-
  47DC  3A1600        		ld	a,(MMLLEN)
  47DF  B7            		or	a
  47E0  281F          		jr	z,MMLZ
  47E2  2A1700        		ld	hl,(MMLADR)
  47E5  7E            		ld	a,(hl)
  47E6  FE2B          		cp	'+'
  47E8  2003          		jr	nz,NOTPLUS
  47EA  1C            		inc	e
  47EB  1809          		jr	MMLP
  47ED                	NOTPLUS:
  47ED  FE2D          		cp	'-'
  47EF  2010          		jr	nz,MMLZ
  47F1  1D            		dec	e
  47F2  F2F647        		jp	p,MMLP
  47F5  15            		dec	d
  47F6                	MMLP:
  47F6  23            		inc	hl
  47F7  221700        		ld	(MMLADR),hl
  47FA  3A1600        		ld	a,(MMLLEN)
  47FD  3D            		dec	a
  47FE  321600        		ld	(MMLLEN),a
                      	
  4801                	MMLZ:
  4801  211E5A        		ld	hl,SCALE-12+1
  4804  19            		add	hl,de
  4805  3A1200        		ld	a,(OCTAVE)	;2~5
  4808  3D            		dec	a
  4809  110C00        		ld	de,000ch
  480C                	MMLLP2:
  480C  19            		add	hl,de
  480D  3D            		dec	a
  480E  20FC          		jr	nz,MMLLP2
  4810  3A1500        		ld	a,(MMLPTCH)
  4813  5F            		ld	e,a
  4814  7E            		ld	a,(hl)
  4815  93            		sub	e
  4816  320600        		ld	(PDIFF),a
                      	
                      	;check number
  4819  2A1700        		ld	hl,(MMLADR)
  481C                	SETLEN:
  481C  CDAC48        		call	GETNUM
  481F  221700        		ld	(MMLADR),hl
  4822  ED5B1300      		ld	de,(LENGTH)	;e=(LENGTH)
  4826  DC8048        		call	c,NUM2LEN
                      	
  4829  3A0500        		ld	a,(TDIFF)
  482C  83            		add	a,e
  482D  D610          		sub	FRAMES
  482F  320500        		ld	(TDIFF),a
                      	
  4832  D1            		pop	de
  4833  E1            		pop	hl
  4834                	MMLEND:
  4834  CDB549        		call	CHGROM0
  4837  C9            		ret
                      	
                      	;O command
  4838                	SINGO:
  4838  CDAC48        		call	GETNUM
  483B  D2BA41        		jp	nc,TALKERR
  483E  FE02          		cp	2
  4840  3002          		jr	nc,SINGONC
  4842  3E02          		ld	a,2
  4844                	SINGONC:
  4844  FE06          		cp	5+1
  4846  3802          		jr	c,SINGOC
  4848  3E05          		ld	a,5
  484A                	SINGOC:
  484A  321200        		ld	(OCTAVE),a
  484D  C39D47        		jp	MMLLP1
                      	
                      	;V command
  4850                	SINGV:
  4850  CDAC48        		call	GETNUM
  4853  D2BA41        		jp	nc,TALKERR
  4856  FE10          		cp	0fh+1
  4858  3802          		jr	c,SINGVEND
  485A  3E0F          		ld	a,0fh
  485C                	SINGVEND:
  485C  87            		add	a,a		;*2
  485D  87            		add	a,a		;*4
  485E  87            		add	a,a		;*8
  485F  87            		add	a,a		;*16
  4860  321100        		ld	(VOLUME),a
  4863  C39D47        		jp	MMLLP1
                      	
                      	;L command
  4866                	SINGL:
  4866  CDAC48        		call	GETNUM
  4869  D2BA41        		jp	nc,TALKERR
  486C  CD8048        		call	NUM2LEN
  486F  7B            		ld	a,e
  4870  321300        		ld	(LENGTH),a
  4873  C39D47        		jp	MMLLP1
                      	
  4876                	SINGR:
  4876  3A1400        		ld	a,(REST)
  4879  B7            		or	a
  487A  CABA41        		jp	z,TALKERR
  487D  C31C48        		jp	SETLEN
                      	
                      	
                      	;convert note-number to frames
                      	;input: a=number, hl=MML address
                      	;output: e=frames, hl=next MML address
                      	;destroy: af,bc,de
  4880                	NUM2LEN:
  4880  B7            		or	a
  4881  2001          		jr	nz,NUMGT0
  4883  3C            		inc	a
  4884                	NUMGT0:
  4884  FE11          		cp	16+1
  4886  3802          		jr	c,NUMLE16
  4888  3E10          		ld	a,16
  488A                	NUMLE16:
  488A  E5            		push	hl
  488B  210001        		ld	hl,FRAMES2*4
  488E  CD0349        		call	DIVI		;de=FRAMES2*4/a<=0100h
  4891  E1            		pop	hl
                      	
  4892  3A1600        		ld	a,(MMLLEN)
  4895  47            		ld	b,a		;;
  4896  B7            		or	a
  4897  C8            		ret	z
  4898  7E            		ld	a,(hl)
  4899  FE2E          		cp	'.'
  489B  C0            		ret	nz
  489C  23            		inc	hl
  489D  05            		dec	b		;;
  489E  78            		ld	a,b
  489F  321600        		ld	(MMLLEN),a
  48A2  7B            		ld	a,e		;
  48A3  1F            		rra			;c-flag=0
  48A4  83            		add	a,e		;*1.5
  48A5  D8            		ret	c
  48A6  5F            		ld	e,a
  48A7  C9            		ret
                      	
                      	
                      	;get 2-digit number
                      	;input: hl=MML address
                      	;output: hl=next MML address, a=data, c-flag(0=no data), (MMLLEN)
                      	;destroy: f,de
                      	
  48A8                	GETNUMLP1:
  48A8  EB            		ex	de,hl
  48A9  35            		dec	(hl)
  48AA  EB            		ex	de,hl
  48AB  23            		inc	hl
                      	
  48AC                	GETNUM:
  48AC  111600        		ld	de,MMLLEN
  48AF  1A            		ld	a,(de)
  48B0  B7            		or	a
  48B1  C8            		ret	z
                      	
  48B2  7E            		ld	a,(hl)
  48B3  FE20          		cp	' '
  48B5  28F1          		jr	z,GETNUMLP1
                      	
  48B7  D630          		sub	'0'
  48B9  FE0A          		cp	'9'-'0'+1
  48BB  D0            		ret	nc
                      	
  48BC  57            		ld	d,a
                      	
  48BD                	GETNUMLP2:
  48BD  23            		inc	hl
  48BE  3A1600        		ld	a,(MMLLEN)
  48C1  3D            		dec	a
  48C2  321600        		ld	(MMLLEN),a
  48C5  7A            		ld	a,d
  48C6  C8            		ret	z		;c-flag=1
                      	
  48C7  7E            		ld	a,(hl)
  48C8  FE20          		cp	' '
  48CA  28F1          		jr	z,GETNUMLP2
                      	
  48CC  7E            		ld	a,(hl)
  48CD  D630          		sub	'0'
  48CF  FE0A          		cp	'9'-'0'+1
  48D1  5F            		ld	e,a
  48D2  7A            		ld	a,d
  48D3  3F            		ccf
  48D4  D8            		ret	c
                      	
  48D5  3A1600        		ld	a,(MMLLEN)
  48D8  3D            		dec	a
  48D9  321600        		ld	(MMLLEN),a
                      	
  48DC  7A            		ld	a,d
  48DD  87            		add	a,a		*2
  48DE  87            		add	a,a		*4
  48DF  82            		add	a,d		*5
  48E0  87            		add	a,a		*10
  48E1  83            		add	a,e
                      	
  48E2  23            		inc	hl
  48E3  37            		scf
  48E4  C9            		ret
                      	
                      	
                      	;check vowel
                      	;input: a (aiueo)
                      	;output: c (0-4), z-flag(1=ok)
                      	;destroy: f
  48E5                	CHKVOW:
  48E5  0E00          		ld	c,0
  48E7  FE61          		cp	'a'
  48E9  C8            		ret	z
  48EA  0C            		inc	c
  48EB  FE69          		cp	'i'
  48ED  C8            		ret	z
  48EE  0C            		inc	c
  48EF  FE75          		cp	'u'
  48F1  C8            		ret	z
  48F2  0C            		inc	c
  48F3  FE65          		cp	'e'
  48F5  C8            		ret	z
  48F6  0C            		inc	c
  48F7  FE6F          		cp	'o'
  48F9  C9            		ret
                      	
                      	
                      	;get (OUTADR)
                      	;output: hl
                      	;destroy: a
  48FA                	GETOUTADR:
  48FA  CDAF49        		call	CHGRAM0
  48FD  2A0E00        		ld	hl,(OUTADR)
  4900  C3B549        		jp	CHGROM0
                      	
                      	
                      	;de=hl/a, (a!=0)
                      	;input: a, hl
                      	;output: de
                      	;destroy: af,bc
  4903                	DIVI:
  4903  110000        		ld	de,0000h
  4906  0608          		ld	b,08h
  4908                	DIVILP1:
  4908  04            		inc	b
  4909  87            		add	a,a
  490A  30FC          		jr	nc,DIVILP1
  490C  1F            		rra
  490D  4F            		ld	c,a
  490E                	DIVILP2:
  490E  7C            		ld	a,h
  490F  3004          		jr	nc,DIVINC1
  4911  91            		sub	c
  4912  B7            		or	a		;reset c-flag
  4913  1804          		jr	DIVINC2
  4915                	DIVINC1:
  4915  91            		sub	c
  4916  3001          		jr	nc,DIVINC2
  4918  81            		add	a,c
  4919                	DIVINC2:
  4919  67            		ld	h,a
  491A  3F            		ccf
  491B  CB13          		rl	e
  491D  CB12          		rl	d
  491F  29            		add	hl,hl
  4920  10EC          		djnz	DIVILP2
                      	
  4922  D0            		ret	nc
  4923  13            		inc	de		;round up
  4924  C9            		ret
                      	
                      	
                      	;check (PDIFF) and get -4<=a<=3 (111...011)
                      	;output: a=value, (PDIFF)=residual, (MMLPTCH)
                      	;destroy: f,b
  4925                	CHKPDIFF:
  4925  3A0600        		ld	a,(PDIFF)
  4928  47            		ld	b,a
  4929  B7            		or	a
  492A  FA3549        		jp	m,DECPITCH2
  492D  FE04          		cp	03h+1
  492F  380A          		jr	c,PITCHEND2
  4931  0603          		ld	b,03h
  4933  1806          		jr	PITCHEND2
  4935                	DECPITCH2:
  4935  FEFC          		cp	0fch
  4937  3002          		jr	nc,PITCHEND2
  4939  06FC          		ld	b,0fch
  493B                	PITCHEND2:
  493B  90            		sub	b
  493C  320600        		ld	(PDIFF),a
  493F  3A1500        		ld	a,(MMLPTCH)
  4942  80            		add	a,b
  4943  321500        		ld	(MMLPTCH),a
  4946  78            		ld	a,b
  4947  E607          		and	07h
  4949  C9            		ret
                      	
                      	
                      	;make no sound with pitch after address
                      	;input: hl=output address
                      	;output: hl,(OUTADR)=next output address
                      	;destroy: af,bc,de
                      	;(RAM)
  494A                	NOSOUND1:
  494A  EB            		ex	de,hl
                      	
  494B  3A0500        		ld	a,(TDIFF)
  494E  47            		ld	b,a
  494F                	NSND1LP:
  494F  C5            		push	bc
  4950  211C5A        		ld	hl,NODATA
  4953  010600        		ld	bc,0006h
  4956  EDB0          		ldir
  4958  CD2549        		call	CHKPDIFF
  495B  12            		ld	(de),a
  495C  13            		inc	de
  495D  C1            		pop	bc
  495E  10EF          		djnz	NSND1LP
                      	
  4960  EB            		ex	de,hl
  4961  3600          		ld	(hl),0
  4963  220E00        		ld	(OUTADR),hl
  4966  C9            		ret
                      	
                      	
                      	;make no sound before address
                      	;input: b=length, de=output address
                      	;destroy: f,hl
  4967                	NOSOUND2:
  4967  D5            		push	de
  4968  C5            		push	bc
  4969  EB            		ex	de,hl
  496A  2B            		dec	hl
  496B  11F9FF        		ld	de,0-7
  496E  CDAF49        		call	CHGRAM0
  4971                	NSND2LP:
  4971  7E            		ld	a,(hl)
  4972  E60F          		and	0fh
  4974  77            		ld	(hl),a
  4975  19            		add	hl,de
  4976  10F9          		djnz	NSND2LP
  4978  CDB549        		call	CHGROM0
  497B  C1            		pop	bc
  497C  D1            		pop	de
  497D  C9            		ret
                      	
                      	
                      	;input: hl
                      	;output: hl=hl+7
                      	;destroy: af,bc
  497E                	OUT7:
  497E  0607          		ld	b,07h
  4980                	OUT7LP1:
  4980  0E00          		ld	c,00h
  4982                	OUT7LP2:
  4982  0C            		inc	c
  4983  CA9D49        		jp	z,OUT7ERR	;time out
  4986  DBE0          		in	a,(0e0h)	;status register
  4988  CB67          		bit	4,a
  498A  2011          		jr	nz,OUT7ERR	;ERR=1
  498C  E640          		and	40h
  498E  CCB549        		call	z,CHGROM0
  4991  CCAF49        		call	z,CHGRAM0
  4994  28EC          		jr	z,OUT7LP2	;wait for REQ=1
  4996  7E            		ld	a,(hl)
  4997  D3E0          		out	(0e0h),a
  4999  23            		inc	hl
  499A  10E4          		djnz	OUT7LP1
  499C  C9            		ret
                      	
  499D                	OUT7ERR:
  499D  3A5AFA        		ld	a,(KEYFLG)
  49A0  F610          		or	10h
  49A2  325AFA        		ld	(KEYFLG),a
  49A5  2A4000        		ld	hl,(STACK)
  49A8  CDB549        		call	CHGROM0
  49AB  F9            		ld	sp,hl
  49AC  3E20          		ld	a,20h
  49AE  C9            		ret
                      	
                      	
                      	;change 0000-3fff to internal RAM
                      	;destroy: a
  49AF                	CHGRAM0:
  49AF  F3            		di
  49B0  3E2D          		ld	a,2dh		;0000-3fff:internal RAM, 4000-7fff:VOICE ROM
                      	;	ld	a,7dh		;for test
  49B2  D3F0          		out	(0f0h),a
  49B4  C9            		ret
                      	
                      	
                      	;change 0000-3fff to BASIC ROM
                      	;destroy: a
  49B5                	CHGROM0:
  49B5  3E21          		ld	a,21h		;0000-3fff:BASIC ROM, 4000-7fff:VOICE ROM
                      	;	ld	a,77h		;for test
  49B7  D3F0          		out	(0f0h),a
  49B9  FB            		ei
  49BA  C9            		ret
                      	
                      	
                      	;for subtitles in PC6001VW
                      	;output to port e3h (for mkII)
  49BB                	_OUTE362:ds	OUTE362-_OUTE362
  4D59                		org	OUTE362
  4D59  D3E3          		out	(0e3h),a
  4D5B  C9            		ret
                      	
                      	;output to port e3h (for 6601)
  4D5C                	_OUTE366:ds	OUTE366-_OUTE366
  52F2                		org	OUTE366
  52F2  D3E3          		out	(0e3h),a
  52F4  C9            		ret
                      	;
                      	
                      	;;voice table
                      	;speed
  52F5                	SPDTBL:
  52F5  020001060405  		db	02h, 00h, 01h, 06h, 04h, 05h
                      	
                      	;vowel
  52FB                	VOWTBL:
  52FB  EB53F553FF5309		dw	M_A, M_I, M_U, M_E, M_O
  5305  1D54275431543B		dw	F_A, F_I, F_U, F_E, F_O
                      	
  530F                	BTBL:
  530F  4F544F544F544F		dw	M_BA, M_BI, M_BU, M_BE, M_BO
  5319  4F544F544F544F		dw	F_BA, F_BI, F_BU, F_BE, F_BO
                      	
  5323                	DTBL:
  5323  5A545A545A545A		dw	M_DA, M_DI, M_DU, M_DE, M_DO
  532D  5A545A545A545A		dw	F_DA, F_DI, F_DU, F_DE, F_DO
                      	
  5337                	GTBL:
  5337  65546554655465		dw	M_GA, M_GI, M_GU, M_GE, M_GO
  5341  65546554655465		dw	F_GA, F_GI, F_GU, F_GE, F_GO
                      	
  534B                	YTBL:
  534B  AE54FF54FF5450		dw	M_YA, M_YI, M_YU, M_YE, M_YO
  5355  CA551B561B566C		dw	F_YA, F_YI, F_YU, F_YE, F_YO
                      	
  535F                	RTBL:
  535F  0E570E5719570E		dw	M_RA, M_RI, M_RU, M_RE, M_RO
  5369  0E570E576B570E		dw	F_RA, F_RI, F_RU, F_RE, F_RO
                      	
  5373                	MTBL:
  5373  BD57BD57BD57BD		dw	M_MA, M_MI, M_MU, M_ME, M_MO
  537D  BD57BD57BD57BD		dw	F_MA, F_MI, F_MU, F_ME, F_MO
                      	
  5387                	NTBL:
  5387  C857C857C857C8		dw	M_NA, M_NI, M_NU, M_NE, M_NO
  5391  C857C857C857C8		dw	F_NA, F_NI, F_NU, F_NE, F_NO
                      	
  539B                	ZTBL:
  539B  D357D357D357D3		dw	M_ZA, M_ZI, M_ZU, M_ZE, M_ZO
  53A5  D357D357D357D3		dw	F_ZA, F_ZI, F_ZU, F_ZE, F_ZO
                      	
  53AF                	STBL:
  53AF  F257F257F257F2		dw	M_SA, M_SI, M_SU, M_SE, M_SO
  53B9  F257F257F257F2		dw	F_SA, F_SI, F_SU, F_SE, F_SO
                      	
  53C3                	HTBL:
  53C3  11583A5863588C		dw	M_HA, M_HI, M_HU, M_HE, M_HO
  53CD  1B5944596D5996		dw	F_HA, F_HI, F_HU, F_HE, F_HO
                      	
  53D7                	CTBL:
  53D7  115A115A115A11		dw	M_CA, M_CI, M_CU, M_CE, M_CO
  53E1  115A115A115A11		dw	F_CA, F_CI, F_CU, F_CE, F_CO
                      	
                      	
                      	;voice data
                      	
                      	;648,1028,2560Hz
  53EB                	M_A:
  53EB  001C000605    		db	0, 28, 0, 6, 5
  53F0  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;360,2226,2834Hz
  53F5                	M_I:
  53F5  0011000812    		db	0, 17, 0, 8, 18
  53FA  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;322,1112,2215Hz
  53FF                	M_U:
  53FF  000F000306    		db	0, 15, 0, 3, 6
  5404  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;524,1741,2340Hz
  5409                	M_E:
  5409  001800040E    		db	0, 24, 0, 4, 14
  540E  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
                      	
                      	;447,781,2500Hz
  5413                	M_O:
  5413  0015000600    		db	0, 21, 0, 6, 0
  5418  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;1057,1787,2962Hz
  541D                	F_A:
  541D  002500090F    		db	0, 37, 0, 9, 15
  5422  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;355,2992,3906Hz
  5427                	F_I:
  5427  0011000E18    		db	0, 17, 0, 14, 24
  542C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;383,1719,2749Hz
  5431                	F_U:
  5431  001300070E    		db	0, 19, 0, 7, 14
  5436  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;598,2724,3511Hz
  543B                	F_E:
  543B  001B000C16    		db	0, 27, 0, 12, 22
  5440  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;561,851,3142Hz
  5445                	F_O:
  5445  0019000A01    		db	0, 25, 0, 10, 1
  544A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;150,800,1750Hz->
  544F                	M_BA:
  544F                	M_BI:
  544F                	M_BU:
  544F                	M_BE:
  544F                	M_BO:
  544F                	F_BA:
  544F                	F_BI:
  544F                	F_BU:
  544F                	F_BE:
  544F                	F_BO:
  544F  01            		db	1
  5450  000100FF00    		db	0, 1, 0, 0-1, 0
  5455  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;150,1800,2600Hz->
  545A                	M_DA:
  545A                	M_DI:
  545A                	M_DU:
  545A                	M_DE:
  545A                	M_DO:
  545A                	F_DA:
  545A                	F_DI:
  545A                	F_DU:
  545A                	F_DE:
  545A                	F_DO:
  545A  01            		db	1
  545B  000100060F    		db	0, 1, 0, 6, 15
  5460  000000F9F7    		db	0, 0, 0, 0-7, 0-9
                      	
                      	;150,2350,2750Hz->
  5465                	M_GA:
  5465                	M_GI:
  5465                	M_GU:
  5465                	M_GE:
  5465                	M_GO:
  5465                	F_GA:
  5465                	F_GI:
  5465                	F_GU:
  5465                	F_GE:
  5465                	F_GO:
  5465  01            		db	1
  5466  000100060A    		db	0, 1, 0, 6, 10
  546B  060206FBF7    		db	6, 2, 6, 0-5, 0-9
                      	
                      	;300,600,2200Hz->
  5470                	M_WA:
  5470  03            		db	3
  5471  000E0003FB    		db	0, 14, 0, 3, 0-5
  5476  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  547B  00140004FF    		db	0, 20, 0, 4, 0-1
  5480  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5485  0019000502    		db	0, 25, 0, 5, 2
  548A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  548F                	F_WA:
  548F  03            		db	3
  5490  000E0003FB    		db	0, 14, 0, 3, 0-5
  5495  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  549A  0019000504    		db	0, 25, 0, 5, 4
  549F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54A4  002000070A    		db	0, 32, 0, 7, 10
  54A9  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	
                      	;300,2200,3050Hz->
  54AE                	M_YA:
  54AE  08            		db	8
  54AF  000E000912    		db	0, 14, 0, 9, 18
  54B4  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54B9  0010000911    		db	0, 16, 0, 9, 17
  54BE  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54C3  0012000910    		db	0, 18, 0, 9, 16
  54C8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54CD  001400080E    		db	0, 20, 0, 8, 14
  54D2  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54D7  001600080D    		db	0, 22, 0, 8, 13
  54DC  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54E1  001800080B    		db	0, 24, 0, 8, 11
  54E6  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54EB  0019000709    		db	0, 25, 0, 7, 9
  54F0  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  54F5  001A000707    		db	0, 26, 0, 7, 7
  54FA  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  54FF                	M_YI:
  54FF                	M_YU:
  54FF  08            		db	8
  5500  000E000912    		db	0, 14, 0, 9, 18
  5505  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  550A  000E000911    		db	0, 14, 0, 9, 17
  550F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5514  000E000810    		db	0, 14, 0, 8, 16
  5519  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  551E  000F00070F    		db	0, 15, 0, 7, 15
  5523  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5528  000F00070D    		db	0, 15, 0, 7, 13
  552D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5532  000F00060C    		db	0, 15, 0, 6, 12
  5537  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  553C  000F00050A    		db	0, 15, 0, 5, 10
  5541  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5546  000F000408    		db	0, 15, 0, 4, 8
  554B  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5550                	M_YE:
  5550  04            		db	4
  5551  000E000912    		db	0, 14, 0, 9, 18
  5556  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  555B  0011000811    		db	0, 17, 0, 8, 17
  5560  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5565  0014000710    		db	0, 20, 0, 7, 16
  556A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  556F  001600060F    		db	0, 22, 0, 6, 15
  5574  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5579                	M_YO:
  5579  08            		db	8
  557A  000E000912    		db	0, 14, 0, 9, 18
  557F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5584  000F000911    		db	0, 15, 0, 9, 17
  5589  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  558E  001000080F    		db	0, 16, 0, 8, 15
  5593  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5598  001100080D    		db	0, 17, 0, 8, 13
  559D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55A2  001200080B    		db	0, 18, 0, 8, 11
  55A7  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55AC  0013000709    		db	0, 19, 0, 7, 9
  55B1  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55B6  0014000706    		db	0, 20, 0, 7, 6
  55BB  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55C0  0015000603    		db	0, 21, 0, 6, 3
  55C5  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	
                      	;300,2200,3050Hz->
  55CA                	F_YA:
  55CA  08            		db	8
  55CB  000E000912    		db	0, 14, 0, 9, 18
  55D0  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55D5  0013000912    		db	0, 19, 0, 9, 18
  55DA  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55DF  0017000911    		db	0, 23, 0, 9, 17
  55E4  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55E9  001A000911    		db	0, 26, 0, 9, 17
  55EE  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55F3  001D000911    		db	0, 29, 0, 9, 17
  55F8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  55FD  001F000910    		db	0, 31, 0, 9, 16
  5602  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5607  0021000910    		db	0, 33, 0, 9, 16
  560C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5611  002300090F    		db	0, 35, 0, 9, 15
  5616  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;300,2200,3050Hz->
  561B                	F_YI:
  561B                	F_YU:
  561B  08            		db	8
  561C  000E000912    		db	0, 14, 0, 9, 18
  5621  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5626  000F000912    		db	0, 15, 0, 9, 18
  562B  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5630  000F000911    		db	0, 15, 0, 9, 17
  5635  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  563A  0010000911    		db	0, 16, 0, 9, 17
  563F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5644  0010000810    		db	0, 16, 0, 8, 16
  5649  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  564E  0011000810    		db	0, 17, 0, 8, 16
  5653  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5658  001200080F    		db	0, 18, 0, 8, 15
  565D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5662  001200080F    		db	0, 18, 0, 8, 15
  5667  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	
                      	;300,2200,3050Hz->
  566C                	F_YE:
  566C  08            		db	8
  566D  000E000912    		db	0, 14, 0, 9, 18
  5672  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5677  0010000A13    		db	0, 16, 0, 10, 19
  567C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5681  0012000A13    		db	0, 18, 0, 10, 19
  5686  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  568B  0014000A14    		db	0, 20, 0, 10, 20
  5690  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5695  0015000B14    		db	0, 21, 0, 11, 20
  569A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  569F  0017000B15    		db	0, 23, 0, 11, 21
  56A4  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56A9  0018000B15    		db	0, 24, 0, 11, 21
  56AE  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56B3  0019000C16    		db	0, 25, 0, 12, 22
  56B8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  56BD                	F_YO:
  56BD  08            		db	8
  56BE  000E000912    		db	0, 14, 0, 9, 18
  56C3  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56C8  0010000911    		db	0, 16, 0, 9, 17
  56CD  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56D2  001200090F    		db	0, 18, 0, 9, 15
  56D7  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56DC  0013000A0E    		db	0, 19, 0, 10, 14
  56E1  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56E6  0015000A0C    		db	0, 21, 0, 10, 12
  56EB  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56F0  0016000A0A    		db	0, 22, 0, 10, 10
  56F5  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  56FA  0017000A07    		db	0, 23, 0, 10, 7
  56FF  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5704  0018000A04    		db	0, 24, 0, 10, 4
  5709  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;150,1800,2600Hz
  570E                	M_RA:
  570E                	F_RA:
  570E                	M_RI:
  570E                	M_RE:
  570E                	F_RI:
  570E                	F_RE:
  570E  01            		db	1
  570F  000100060E    		db	0, 1, 0, 6, 14
  5714  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	
  5719                	M_RU:
  5719  04            		db	4
  571A  001400FE09    		db	0, 20, 0, 0-2, 9
  571F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5724  001300FF08    		db	0, 19, 0, 0-1, 8
  5729  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  572E  0012000107    		db	0, 18, 0, 1, 7
  5733  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5738  0011000207    		db	0, 17, 0, 2, 7
  573D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5742                	M_RO:
  5742  04            		db	4
  5743  001400FE09    		db	0, 20, 0, 0-2, 9
  5748  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  574D  0015000007    		db	0, 21, 0, 0, 7
  5752  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5757  0015000205    		db	0, 21, 0, 2, 5
  575C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5761  0015000402    		db	0, 21, 0, 4, 2
  5766  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  576B                	F_RU:
  576B  04            		db	4
  576C  001400FE09    		db	0, 20, 0, 0-2, 9
  5771  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5776  001400010A    		db	0, 20, 0, 1, 10
  577B  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5780  001300030C    		db	0, 19, 0, 3, 12
  5785  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  578A  001300050D    		db	0, 19, 0, 5, 13
  578F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;425,1300,1600Hz
  5794                	F_RO:
  5794  04            		db	4
  5795  001400FE09    		db	0, 20, 0, 0-2, 9
  579A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  579F  0016000207    		db	0, 22, 0, 2, 7
  57A4  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  57A9  0017000505    		db	0, 23, 0, 5, 5
  57AE  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  57B3  0018000703    		db	0, 24, 0, 7, 3
  57B8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
                      	;275,900,2200Hz
  57BD                	M_MA:
  57BD                	M_MI:
  57BD                	M_MU:
  57BD                	M_ME:
  57BD                	M_MO:
  57BD                	F_MA:
  57BD                	F_MI:
  57BD                	F_MU:
  57BD                	F_ME:
  57BD                	F_MO:
  57BD  01            		db	1
  57BE  000C000302    		db	0, 12, 0, 3, 2
  57C3  0600060000    		db	6, 0, 6, 0, 0
                      	
                      	;275,1700,2600Hz
  57C8                	M_NA:
  57C8                	M_NI:
  57C8                	M_NU:
  57C8                	M_NE:
  57C8                	M_NO:
  57C8                	F_NA:
  57C8                	F_NI:
  57C8                	F_NU:
  57C8                	F_NE:
  57C8                	F_NO:
  57C8  01            		db	1
  57C9  000C00060E    		db	0, 12, 0, 6, 14
  57CE  0600060000    		db	6, 0, 6, 0, 0
                      	
  57D3                	M_ZA:
  57D3                	M_ZI:
  57D3                	M_ZU:
  57D3                	M_ZE:
  57D3                	M_ZO:
  57D3                	F_ZA:
  57D3                	F_ZI:
  57D3                	F_ZU:
  57D3                	F_ZE:
  57D3                	F_ZO:
                      	;d:150,1800,2600Hz->
                      	;z:200,1800,2600Hz
  57D3  03            		db	3
  57D4  000100060F    		db	0, 1, 0, 6, 15
  57D9  000000F9F7    		db	0, 0, 0, 0-7, 0-9
  57DE  000106060F    		db	0, 1, 6, 6, 15
  57E3  000200FEFC    		db	0, 2, 0, 0-2, 0-4
  57E8  000706060F    		db	0, 7, 6, 6, 15
  57ED  000200FEFC    		db	0, 2, 0, 0-2, 0-4
                      	
  57F2                	M_SA:
  57F2                	M_SI:
  57F2                	M_SU:
  57F2                	M_SE:
  57F2                	M_SO:
  57F2                	F_SA:
  57F2                	F_SI:
  57F2                	F_SU:
  57F2                	F_SE:
  57F2                	F_SO:
                      	;200,1800,2600Hz
  57F2  03            		db	3
  57F3  000706060F    		db	0, 7, 6, 6, 15
  57F8  000200FEFC    		db	0, 2, 0, 0-2, 0-4
  57FD  000706060F    		db	0, 7, 6, 6, 15
  5802  000200FEFC    		db	0, 2, 0, 0-2, 0-4
  5807  000706060F    		db	0, 7, 6, 6, 15
  580C  000200FEFC    		db	0, 2, 0, 0-2, 0-4
                      	
                      	
  5811                	M_HA:
  5811  04            		db	4
  5812  001C000605    		db	0, 28, 0, 6, 5
  5817  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  581C  001C000605    		db	0, 28, 0, 6, 5
  5821  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5826  001C000605    		db	0, 28, 0, 6, 5
  582B  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5830  001C000605    		db	0, 28, 0, 6, 5
  5835  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  583A                	M_HI:
  583A  04            		db	4
  583B  0011000812    		db	0, 17, 0, 8, 18
  5840  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5845  0011000812    		db	0, 17, 0, 8, 18
  584A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  584F  0011000812    		db	0, 17, 0, 8, 18
  5854  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5859  0011000812    		db	0, 17, 0, 8, 18
  585E  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5863                	M_HU:
  5863  04            		db	4
  5864  000F000306    		db	0, 15, 0, 3, 6
  5869  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  586E  000F000306    		db	0, 15, 0, 3, 6
  5873  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5878  000F000306    		db	0, 15, 0, 3, 6
  587D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5882  000F000306    		db	0, 15, 0, 3, 6
  5887  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  588C                	M_HE:
  588C  06            		db	6
  588D  001800040E    		db	0, 24, 0, 4, 14
  5892  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
  5897  001800040E    		db	0, 24, 0, 4, 14
  589C  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
  58A1  001800040E    		db	0, 24, 0, 4, 14
  58A6  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
  58AB  001800040E    		db	0, 24, 0, 4, 14
  58B0  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
  58B5  001800040E    		db	0, 24, 0, 4, 14
  58BA  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
  58BF  001800040E    		db	0, 24, 0, 4, 14
  58C4  06FD06FAF8    		db	6, 0-3, 6, 0-6, 0-8
                      	
  58C9                	M_HO:
  58C9  04            		db	4
  58CA  0015000600    		db	0, 21, 0, 6, 0
  58CF  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  58D4  0015000600    		db	0, 21, 0, 6, 0
  58D9  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  58DE  0015000600    		db	0, 21, 0, 6, 0
  58E3  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  58E8  0015000600    		db	0, 21, 0, 6, 0
  58ED  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  58F2                	M_HY:
  58F2  04            		db	4
  58F3  000E000912    		db	0, 14, 0, 9, 18
  58F8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  58FD  000E000912    		db	0, 14, 0, 9, 18
  5902  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5907  000E000912    		db	0, 14, 0, 9, 18
  590C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5911  000E000912    		db	0, 14, 0, 9, 18
  5916  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  591B                	F_HA:
  591B  04            		db	4
  591C  002500090F    		db	0, 37, 0, 9, 15
  5921  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5926  002500090F    		db	0, 37, 0, 9, 15
  592B  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5930  002500090F    		db	0, 37, 0, 9, 15
  5935  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  593A  002500090F    		db	0, 37, 0, 9, 15
  593F  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5944                	F_HI:
  5944  04            		db	4
  5945  0011000E18    		db	0, 17, 0, 14, 24
  594A  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  594F  0011000E18    		db	0, 17, 0, 14, 24
  5954  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5959  0011000E18    		db	0, 17, 0, 14, 24
  595E  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5963  0011000E18    		db	0, 17, 0, 14, 24
  5968  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  596D                	F_HU:
  596D  04            		db	4
  596E  001300070E    		db	0, 19, 0, 7, 14
  5973  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5978  001300070E    		db	0, 19, 0, 7, 14
  597D  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5982  001300070E    		db	0, 19, 0, 7, 14
  5987  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  598C  001300070E    		db	0, 19, 0, 7, 14
  5991  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5996                	F_HE:
  5996  04            		db	4
  5997  001B000C16    		db	0, 27, 0, 12, 22
  599C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59A1  001B000C16    		db	0, 27, 0, 12, 22
  59A6  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59AB  001B000C16    		db	0, 27, 0, 12, 22
  59B0  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59B5  001B000C16    		db	0, 27, 0, 12, 22
  59BA  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  59BF                	F_HO:
  59BF  04            		db	4
  59C0  0019000A01    		db	0, 25, 0, 10, 1
  59C5  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59CA  0019000A01    		db	0, 25, 0, 10, 1
  59CF  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59D4  0019000A01    		db	0, 25, 0, 10, 1
  59D9  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59DE  0019000A01    		db	0, 25, 0, 10, 1
  59E3  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  59E8                	F_HY:
  59E8  04            		db	4
  59E9  000E000912    		db	0, 14, 0, 9, 18
  59EE  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59F3  000E000912    		db	0, 14, 0, 9, 18
  59F8  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  59FD  000E000912    		db	0, 14, 0, 9, 18
  5A02  060006FBF9    		db	6, 0, 6, 0-5, 0-7
  5A07  000E000912    		db	0, 14, 0, 9, 18
  5A0C  060006FBF9    		db	6, 0, 6, 0-5, 0-7
                      	
  5A11                	M_CA:
  5A11                	M_CI:
  5A11                	M_CU:
  5A11                	M_CE:
  5A11                	M_CO:
  5A11                	F_CA:
  5A11                	F_CI:
  5A11                	F_CU:
  5A11                	F_CE:
  5A11                	F_CO:
                      	;d:150,1800,2600Hz->
                      	;3:200,1300,2400Hz
  5A11  01            		db	1
  5A12  000106060F    		db	0, 1, 6, 6, 15
  5A17  FC00FEFBF9    		db	0-4, 0, 0-2, 0-5, 0-7
                      	
                      	
                      	;no sound
  5A1C                	NODATA:
  5A1C  090000000000  		db	09h, 00h, 00h, 00h, 00h, 00h
                      	
                      	
  5A22                	TONETBL:
                      	;		a  b   c  d  e  f  g
  5A22  090B0002040507		db	9, 11, 0, 2, 4, 5, 7
                      	
                      	
  5A29                	SCALE:
                      	;		c-
  5A29  62            		db	98
                      	;o2		c/b+	c+/d-	d	d+/e-	e/f-	f/e+
  5A2A  626262625B54  		db	98,	98,	98,	98,	91,	84
                      	;		f+/g-	g	g+a/-	a	a+/b-	b/c-
  5A30  4D47423C3733  		db	77,	71,	66,	60,	55,	51
                      	
                      	;o3		c/b+	c+/d-	d	d+/e-	e/f-	f/e+
  5A36  2E2A26221E1B  		db	46,	42,	38,	34,	30,	27,
                      	;		f+/g-	g	g+a/-	a	a+/b-	b/c-
  5A3C  1815120F0D0A  		db	24,	21,	18,	15,	13,	10
                      	
                      	;o4		c/b+	c+/d-	d	d+/e-	e/f-	f/e+
  5A42  0806040200FE  		db	8,	6,	4,	2,	0,	0-2,
                      	;		f+/g-	g	g+a/-	a	a+/b-	b/c-
  5A48  FDFBFAF9F7F6  		db	0-3,	0-5,	0-6,	0-7,	0-9,	0-10
                      	
                      	;o5		c/b+	c+/d-	d	d+/e-	e/f-	f/e+
  5A4E  F5F4F3F2F1F0  		db	0-11,	0-12,	0-13,	0-14,	0-15,	0-16
                      	;		f+/g-	g	g+a/-	a	a+/b-	b/c-
  5A54  EFEFEEEDEDEC  		db	0-17,	0-17,	0-18,	0-19,	0-19,	0-20
                      	;		b+
  5A5A  EC            		db	0-20
                      	
                      	
                      	
                      	;VOICEROM end
  5A5B                	_8000H:	ds	8000h-_8000H
                      	
  8000                		end
